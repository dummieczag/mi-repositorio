Cosas
=====

Exportar Excel
--------------

.. code-block:: python

   from openpyxl import Workbook
    from django.http import HttpResponse

    def export_excel(request):
        response = HttpResponse(content_type='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')
        response['Content-Disposition'] = 'attachment; filename="mydata.xlsx"'

        workbook = Workbook()
        worksheet = workbook.active
        worksheet.title = 'My Data'

        # Write header row
        header = ['ID', 'Name', 'Email']
        for col_num, column_title in enumerate(header, 1):
            cell = worksheet.cell(row=1, column=col_num)
            cell.value = column_title

        # Write data rows
        queryset = MyModel.objects.all().values_list('id', 'name', 'email')
        for row_num, row in enumerate(queryset, 1):
            for col_num, cell_value in enumerate(row, 1):
                cell = worksheet.cell(row=row_num+1, column=col_num)
                cell.value = cell_value

        workbook.save(response)

        return response